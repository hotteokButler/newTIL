# Request Memoization

## âœ… 1. í•µì‹¬ ì»¨ì…‰

### â€¢ ê¸°ëŠ¥ì´ ë§Œë“¤ì–´ì§„ ì´ìœ 

- React(Next.js)ê°€ ë Œë”ë§ ì¤‘ ì¤‘ë³µëœ `fetch(GET)` ìš”ì²­ì´ ë°œìƒí•  ê²½ìš°, ë™ì¼í•œ URL/ì˜µì…˜ì´ë©´ **í•œ ë²ˆë§Œ ì‹¤í–‰**í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ë©”ëª¨ë¦¬ì—ì„œ ë°˜í™˜í•˜ì—¬ íš¨ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ ë„ìž…ë¨
  - ì¦‰, ë Œë”ë§ ë„ì¤‘ì—ëŠ” ë„¤íŠ¸ì›Œí¬ ìš”ì²­ íšŸìˆ˜ë¥¼ ì¤„ì´ëŠ” â€œì¤‘ë³µ ì œê±°(deduplication)"ìš©
- ì„œë²„ ì»´í¬ë„ŒíŠ¸ì˜ ë„ìž…ìœ¼ë¡œ, data fetching patternì´ ë³€í™”í•˜ê³  ìžˆê¸° ë•Œë¬¸
  - [page router] - ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ fetch ëœ ë°ì´í„°ëŠ” propsë¡œ ì „ë‹¬
  - â¬‡ï¸
  - [app router] - ê° componentë§ˆë‹¤ í•„ìš” ì‹œ ê°ê° ë°ì´í„° fetchí•´ì„œ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš© (ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì¼í•œ data ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìƒê¹€)

### â€¢ í•µì‹¬ ë™ìž‘

- **GET** ë°©ì‹ `fetch`ë§Œ ë©”ëª¨ì´ì œì´ì…˜ ëŒ€ìƒ
- ì„œë²„ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì˜ render íŒ¨ìŠ¤ ë™ì•ˆ ìž‘ë™
- ê°™ì€ ìš”ì²­ URL + ì˜µì…˜ì´ë¼ë©´ ì²« í˜¸ì¶œ ì‹œ MISS â†’ ìš”ì²­ í›„ ìºì‹œ ì €ìž¥ â†’ ì´í›„ í˜¸ì¶œì€ HIT â†’ ìºì‹œëœ ê°’ì„ ë°˜í™˜.
- ë Œë”ë§ ì¢…ë£Œ í›„ í•´ë‹¹ ìºì‹œëŠ” ëª¨ë‘ ì œê±°ë¨

## ðŸ“Š 2. ë™ìž‘ í”„ë¡œì„¸ìŠ¤ (ë‹¤ì´ì–´ê·¸ëž¨)

```text
              [Next server                                         ] [ ë°±ì—”ë“œ ì„œë²„ ]
              [ì‚¬ì „ ë Œë”ë§           [ ë°ì´í„° ìºì‹œ]]  [ ë°ì´í„° ìºì‹œ]

[ì ‘ì†ìš”ì²­] â†’ [fetch(`/api/A`)] --------â†’ [ miss ] -â†’ | â†’ [ skip ] â†’ |
[html] â†---------------------------------- [set]  â†-----------------|
       ----â†’ [fetch(`/api/A`)] --------â†’ [ hit  ]   |
       â†----------------------------------          |
       ----â†’ [fetch(`/api/A`)] --------â†’ [ hit  ]   |
[html] â†-------------------------------------       |

```

- ë Œë”ë§ ìš”ì²­ ë™ì•ˆë§Œ ìºì‹œ ì¡´ìž¬, ì¢…ë£Œ í›„ ì†Œë©¸
- â€œMISS â†’ SET â†’ HITâ€ íë¦„ìœ¼ë¡œ ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€

## âš™ï¸ 3. ì˜µì…˜ì„ í†µí•œ ì²˜ë¦¬ ë°©ë²•

- **ë©”ëª¨ì´ì œì´ì…˜ ëŒ€ìƒ ì œì™¸**

  - `AbortController`ì˜ `signal` ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ìš”ì²­ë§Œ ìºì‹œì—ì„œ ì œì™¸

- **ìžë™ ë©”ëª¨ì´ì œì´ì…˜ ëŒ€ìƒì€ GETë§Œ**

  - POST, DELETE ë“±ì€ ê¸°ë³¸ì ìœ¼ë¡œ memoization ë˜ì§€ ì•Šìœ¼ë©°, ë‹¤ë¥¸ ë©”ì„œë“œë¡œëŠ” ìºì‹±ì´ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤

## ðŸ’¾ 4. Data Cacheì™€ì˜ ì°¨ì´ì 

| êµ¬ë¶„            | Request Memoization                 | Data Cache                                                      |
| --------------- | ----------------------------------- | --------------------------------------------------------------- |
| **ë²”ìœ„**        | ë‹¨ì¼ í™”ë©´ ë Œë”ë§(request lifecycle) | ì„œë²„ ìš”ì²­ ê°„ ì§€ì† (ì˜ì† ìºì‹œ : ì„œë²„ ê°€ë™ì¤‘ì—ëŠ” ì˜êµ¬ì  ë³´ê´€)     |
| **ê¸°ê°„**        | ê°™ì€ render íŒ¨ìŠ¤ ë™ì•ˆë§Œ             | ì§€ì •ëœ revalidate ì‹œê°„, í˜¹ì€ íƒœê·¸ ê¸°ë°˜ìœ¼ë¡œ ì˜ì†                 |
| **ë©”ì„œë“œ ì§€ì›** | GET ë§Œ                              | GET ê¸°ë³¸ì´ë©°, POST ë“±ë„ ìºì‹œ ì˜µì…˜ ì‚¬ìš© ì‹œ ê°€ëŠ¥                  |
| **ë©”ëª¨ë¦¬ ìœ„ì¹˜** | ì„œë²„ RAM (ë©”ëª¨ë¦¬ìš© ìž„ì‹œ ì €ìž¥)       | HTTP ìºì‹œ/ì„œë²„ ìºì‹œ (íŒŒì¼, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ë“± ë‹¤ì–‘)              |
| **ëª©ì **        | ì¤‘ë³µ fetch í˜¸ì¶œ ì œê±°                | ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤/APIì— ëŒ€í•œ í˜¸ì¶œëŸ‰ ì ˆê° ë° ìž¬ì‚¬ìš©               |
| **ì œì–´ ë°©ì‹**   | ìžë™; signalë¡œ ì˜ˆì™¸ ì²˜ë¦¬ ê°€ëŠ¥       | `{ cache: 'force-cache' }`, `next.revalidate`, íƒœê·¸ ë“±ìœ¼ë¡œ êµ¬ì„± |

### ðŸ“š ì¸ìš© (References)

> - [í•œ ìž… í¬ê¸°ë¡œ ìž˜ë¼ë¨¹ëŠ” Next.js(v15) ê°•ì˜ | ì´ì •í™˜ Winterlood](https://www.inflearn.com/course/%ED%95%9C%EC%9E%85-%ED%81%AC%EA%B8%B0-nextjs)
> - [Request Memoization - Next.js Docs](https://nextjs.org/docs/app/building-your-application/caching#request-memoization)
> - [Caching and Revalidating - Next.js Docs](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating)
> - [Route Handlers - Next.js Docs](https://nextjs.org/docs/app/building-your-application/routing/route-handlers)
> - [unstable_cache - API Reference](https://nextjs.org/docs/app/api-reference/functions/unstable_cache)
