## 스트리밍(Streaming)

- 서버 -> 클라이언트 데이터 전송 시,<br/>
  데이터의 크기가 크거나, 서버 측에서 데이터 준비하는데 시간이 오래 걸리게 되어 빠르게 전송하기 어려울 때<br/>
  데이터를 잘게 쪼개어 작은 용량의 데이터를 연속적으로 전송하는 기술

- Next에서는 자체적으로 스트리밍 기능 제공

  - 특정 페이지 접속 시 빠르게 렌더링 되는 단순 컴포넌트 먼저 렌더링,
  - 데이터 패칭이 일어나는 곳은 대체 컴포넌트를 보여준 후 따로 전달해서 렌더링
  - 괜찮은 사용자 경험을 제공 가능

- `Dynamic Page`에 자주 사용된다
  - `Dynamic Page`는 빌드타입에 생성되지 않아 full route cache에 저장이 되지 않기에 내부 데이터 패칭이 오래 걸리게 되면 페이지 전체 응답이 느려져 사용자 경험이 떨어질 수 있기 때문에

### `Streaming` 주의사항

1. 레이아웃 컴포넌트처럼 해당 경로 아래에 있는 모든 페이지 컴포넌트들 도전부 스트리밍 되도록 설정됨
2. async 키워드가 붙은 비동기적으로 작동하는 컴포넌트에만 적용됨
3. 페이지 컴포넌트기 아닌, 별도의 컴포넌트에 적용 원할 시 Suspense 컴포넌트를 별도로 활용해야함
4. loading.tsx 파일로 설정된 스트리밍은 브라우저 쿼리 스트링이 변경될 때는 트리거링 되지 않음

### `Suspense` 컴포넌트 활용

- 페이지 단위가 아닌 컴포넌트 단위로 세밀하고 자유롭게 Streaming 설정 가능
- 최초로 한번 내부 컴포넌트의 로딩이 완료된 이후 내부 어떤한 컨텐츠가 변경된다 해도 기본적으로 새롭게 다시 로딩상태로 돌아가지 않음
  - 쿼리 스트링이 변경 될 때 마다 새로 로딩 ui를 렌더링 하려면?
  - 이때는 key 값을 바꾸어 query string이 바귈 때 마다 컴포넌트 자체를 리액트에게 아예 새로운 컴포넌트로 인식하게 만듦 -> component 자체를 아예 새롭게 화면에 그리도록 설정 해 준 것
    - 리액트에서는 키 값이 바뀌면 컴포넌트가 새로 생성 되었다고 인식하게 되는 것을 이용
- 여러개의 비동기 컴포넌트를 동시다발적으로 스트리밍할 때 더 효과적임
  - 병렬로 컴포넌트들이 완료되는 순서대로 화면에 각각 렌더링 됨
