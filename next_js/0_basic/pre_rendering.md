# 📘 Next.js 사전 렌더링 (Pre Rendering) 완전 정리

## 1. 사전 렌더링 (Pre Rendering)이란?

> **브라우저 요청 이전에 서버에서 미리 HTML을 렌더링해 응답하는 방식**입니다.  
> React의 CSR(Client Side Rendering)에서 발생하는 **초기 로딩 지연**, **SEO 문제**, **FCP 성능 저하** 등의 문제를 해결하며, **Next.js의 기본 렌더링 전략**입니다.

### ✅ 특징

- 서버에서 완성된 HTML을 반환 → 브라우저가 즉시 콘텐츠 표시 가능
- JavaScript는 이후 Hydration 과정에서 활성화됨
- **FCP(First Contentful Paint)**를 포함한 주요 성능 지표를 크게 개선
- SEO 친화적

## 2. 사용자 요청 흐름 (Pre Rendering 기준)

```text
[User Browser]
      |
      | HTTP Request
      v
[Server (Next.js)]
      |
      | ↓ 미리 렌더링된 HTML + JS Bundle
      v
[Browser 화면 렌더링]
      |
      | ↓ JS Hydration
      v
인터랙션 가능한 완성 페이지
```

## 3. CSR과 Pre Rendering 비교

| 항목        | CSR (Client Side Rendering) | Pre Rendering (Next.js)      |
| ----------- | --------------------------- | ---------------------------- |
| 렌더링 위치 | 브라우저 (Client)           | 서버 (Server)                |
| 초기 HTML   | 빈 `<div id="root">`        | 완성된 HTML                  |
| FCP         | 느림                        | 빠름                         |
| SEO         | 불리                        | 유리                         |
| 사용자 흐름 | HTML → JS 로딩 → 렌더링     | HTML 즉시 렌더링 → Hydration |
| UX          | 로딩 중 빈 화면 가능        | 초기 콘텐츠 즉시 표시        |

## 4. 주요 웹 성능 지표 (Core Web Vitals 포함)

> 웹 페이지 로딩 품질을 수치화한 성능 지표입니다.

| 지표                               | 정의                                                            | 권장 기준   | 설명                                |
| ---------------------------------- | --------------------------------------------------------------- | ----------- | ----------------------------------- |
| **FCP** (First Contentful Paint)   | 사용자에게 **처음으로 의미 있는 콘텐츠**가 보이기까지 걸린 시간 | ≤ **1.8초** | 사전 렌더링 시 대폭 개선됨          |
| **LCP** (Largest Contentful Paint) | 가장 큰 콘텐츠(예: 이미지, 제목 등)가 보이는 데 걸리는 시간     | ≤ **2.5초** | HTML에 포함되면 빠르게 출력 가능    |
| **TTI** (Time to Interactive)      | 사용자가 페이지와 **상호작용**할 수 있는 시점                   | ≤ **3.8초** | JS 로딩 최적화와 연관               |
| **TBT** (Total Blocking Time)      | 사용자 입력을 **막고 있는 시간 총합**                           | ≤ **200ms** | JS 실행량이 많을수록 증가           |
| **CLS** (Cumulative Layout Shift)  | 페이지 내 **레이아웃 불안정성** 측정                            | ≤ **0.1**   | 이미지 사이즈 명시 등으로 개선 가능 |

> `// FCP: 최초 콘텐츠 표시 시간`  
> `// LCP: 가장 큰 콘텐츠 표시 시간`  
> `// TTI: 인터랙션 가능 시점`  
> `// TBT: 인터랙션 지연 총합`  
> `// CLS: 화면이 튀는 불안정성 측정`

## 5. Next.js의 사전 렌더링 방식 3가지

| 방식                                      | 설명                                     | 트리거 시점                    | 사용 예시                          |
| ----------------------------------------- | ---------------------------------------- | ------------------------------ | ---------------------------------- |
| **SSG (Static Site Generation)**          | 정적 HTML 파일을 **빌드 시 미리 생성**   | `next build` 시점              | 블로그, 마케팅 페이지              |
| **SSR (Server Side Rendering)**           | HTML을 **요청 시마다 서버에서 생성**     | 각 요청 시                     | 로그인 사용자용 대시보드           |
| **ISR (Incremental Static Regeneration)** | 기존 SSG에 **재생성 타이머**를 붙인 방식 | 일정 시간 후 백그라운드 재생성 | 게시판, 뉴스 등 자주 바뀌는 페이지 |

### 📌 요약 비교

| 항목        | SSG                     | SSR                  | ISR                       |
| ----------- | ----------------------- | -------------------- | ------------------------- |
| 렌더링 시점 | 빌드 타임               | 요청 시              | 빌드 타임 + 갱신 주기     |
| 성능        | 최고 (캐시)             | 느림 (요청마다)      | 중간 (부분 갱신)          |
| SEO         | 우수                    | 우수                 | 우수                      |
| 사용성      | 자주 바뀌지 않는 페이지 | 로그인 기반 / 실시간 | 자주 바뀌지만 실시간 아님 |

## 6. Pre Rendering과 성능 지표의 관계

| Pre Rendering 효과         | 향상되는 성능 지표 | 설명                             |
| -------------------------- | ------------------ | -------------------------------- |
| HTML 미리 생성 → 빠른 표시 | **FCP, LCP**       | 사용자에게 초기 화면 빠르게 제공 |
| 필요시 캐싱/부분 갱신      | **TTI, TBT**       | JS 로딩/처리 부담 감소           |
| 구조 안정성 향상           | **CLS**            | 이미지/텍스트 위치 예측 가능     |

## ✅ 결론

- Pre Rendering은 CSR의 UX, SEO, 성능 문제를 효과적으로 해결하는 전략입니다.
- **Next.js는 기본적으로 Pre Rendering 기반**이며, **SSG / SSR / ISR**을 통해 다양한 요구사항에 맞는 페이지 최적화가 가능합니다.
- 성능 지표(FCP, LCP, TTI 등)는 **사용자 경험과 직결**되며, Pre Rendering을 잘 활용하면 대폭 개선할 수 있습니다.

> ### 참고
>
> [한입 크기로 배우는 Next.js ](https://www.inflearn.com/course/%ED%95%9C%EC%9E%85-%ED%81%AC%EA%B8%B0-nextjs)
